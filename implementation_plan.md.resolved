# Gemini 学生认证辅助平台 - 实施计划

## 项目概述

构建一个对接 [neigui.1key.me](https://neigui.1key.me/) 的学生认证辅助平台，用户通过卡密激活 SheerID 验证链接，验证**成功才消耗卡密**，失败则卡密保持可用。

---

## 用户需求确认

> [!IMPORTANT]
> **核心业务规则**：卡密仅在验证成功时才被消耗，失败/异常时回滚到"未使用"状态。

### 上游 API 分析结果

基于对 neigui.1key.me 的分析，确认以下技术细节：

| 端点 | 方法 | 功能 | 认证 |
|------|------|------|------|
| `/api/batch` | POST | 批量验证（SSE响应） | CSRF Token + CDK |
| `/api/cancel` | POST | 取消验证 | CSRF Token |
| `/api/check-status` | POST | 查询pending状态 | 无 |
| `/api/status` | GET | 系统状态 | 无 |
| `/api/fronted/config` | GET | 前端配置 | 无 |

### 卡密绑定与去重机制

> [!IMPORTANT]
> **重要发现**：重复提交已验证的链接会消耗 CDK 配额，即使返回失败！
> 因此必须实现本地去重检查，避免浪费配额。

**核心逻辑**：
1. 卡密成功消耗后，与 verificationId **永久绑定**
2. 用户提交链接前，先查本地数据库是否已有该 verificationId 的成功记录
3. 如果已有记录，直接返回历史结果（不调用上游 API，节省配额）
4. 用户可用已消耗的卡密查询其绑定的验证结果

```mermaid
flowchart TD
    A[用户提交链接] --> B{提取 verificationId}
    B --> C{本地数据库查询}
    C -->|已有成功记录| D[直接返回历史结果]
    C -->|无记录| E[调用上游 API]
    E --> F{验证结果}
    F -->|Success| G[绑定卡密 + 记录结果]
    F -->|Fail/Error| H[回滚卡密]
```

**并发与幂等要求**：
- 同一 verificationId 只允许一个活跃任务；重复请求直接复用已有 job/结果
- 同一卡密同一时间只允许一个锁定（数据库事务 + 状态机）
- 本地拦截并发重复请求，避免上游配额被重复消耗

**关键发现**：
- **CDK 使用方式**：作为 `hCaptchaToken` 字段传入，用于绕过验证码
- **批量限制**：使用 CDK 时最大 5 个 ID/请求
- **CSRF Token**：需从页面 `window.CSRF_TOKEN` 获取
- **响应格式**：SSE 事件流（`text/event-stream`）
- **pending 处理**：需轮询 `/api/check-status` 直到最终结果
- **SSE 容错**：断线/重复事件/空事件需幂等处理；已取得 checkToken 时可回落到 `/api/check-status` 轮询兜底

### SSE 事件流程（实测验证）

> [!NOTE]
> 经实际验证测试，完整流程约需 30-35 秒，涉及多个 SSE 事件：

```mermaid
sequenceDiagram
    participant C as 客户端
    participant N as neigui.1key.me
    participant S as SheerID

    C->>N: POST /api/batch (SSE)
    N-->>C: event: processing
    N->>S: 提交验证
    S-->>N: 返回 pending
    N-->>C: event: pending (Waiting for review...)
    loop 轮询 (~30s)
        N->>S: 检查状态
    end
    S-->>N: 返回 success/fail
    N-->>C: event: result (success/fail + targetUrl)
```

**关键时序**：
| 阶段 | 耗时 | 说明 |
|------|------|------|
| Processing | 1-2s | 初始提交 |
| Pending | 20-40s | 等待 SheerID 审核 |
| Result | <1s | 最终结果 |

### 已知错误类型

经实际测试，上游 API 会返回以下错误：

| 错误信息 | 原因 | 处理方式 |
|---------|------|----------|
| `Please copy sheerid link with right click. DO NOT OPEN IN BROWSER.` | 用户点击进入页面后复制的链接已被"激活"，验证会话已开始 | 提示用户右键复制链接 |
| `验证ID不合法: xxx (仅支持69或6a开头)` | verificationId 格式错误（长度、前缀不符） | 前端即时校验拦截 |
| `Verification already completed` | 链接已被验证过（重复提交） | 本地去重检查，返回历史结果 |

### verificationId 格式要求

> [!IMPORTANT]
> 经对 neigui.1key.me 前端代码分析确认以下验证规则：

| 校验项 | 要求 | 说明 |
|--------|------|------|
| **长度** | 24 位 | MongoDB ObjectId 格式 |
| **字符集** | 十六进制 | 仅 `0-9` 和 `a-f` |
| **前缀** | `69` 或 `6a` | 系统仅支持这两种前缀 |

**前端即时验证正则**：
```javascript
const VALID_ID_REGEX = /^(69|6a)[a-fA-F0-9]{22}$/i;
```

> [!CAUTION]
> **最重要的用户提示**：用户必须**右键点击按钮 → 复制链接地址**，而不是点击进入页面后再复制浏览器地址栏的 URL。
>
> ![正确操作示意](file:///C:/Users/WuWenbin/.gemini/antigravity/brain/c026cb27-90dd-4bd0-87bc-db8732cf54f2/uploaded_media_1770010498326.png)

---

## 技术架构

```mermaid
graph TB
    subgraph Frontend["前端 (Next.js)"]
        UP[用户页面]
        AP[管理员页面]
    end
    
    subgraph Backend["后端 API (Next.js API Routes)"]
        VA[验证 API]
        KA[卡密 API]
        SA[统计 API]
    end
    
    subgraph Database["数据库 (SQLite + Prisma)"]
        CK[(CardKey)]
        VJ[(VerificationJob)]
        DS[(DailyStats)]
    end
    
    subgraph External["外部服务"]
        NG[neigui.1key.me]
    end
    
    UP --> VA
    AP --> KA
    UP --> SA
    VA --> NG
    VA --> CK
    VA --> VJ
    KA --> CK
    SA --> DS
```

### 技术栈选择

| 层级 | 技术 | 理由 |
|------|------|------|
| 框架 | Next.js 14 | 全栈框架，API Routes 简化后端 |
| 数据库 | SQLite | 轻量、无需额外部署 |
| ORM | Prisma | 类型安全、迁移管理 |
| 样式 | Vanilla CSS | 精细控制，高定制 |
| 状态管理 | React Context + SWR | 简单场景足够 |

---

## 数据模型设计

### 卡密状态机

```mermaid
stateDiagram-v2
    [*] --> Unused: 创建
    Unused --> Locked: 开始验证
    Locked --> Consumed: 验证成功
    Locked --> Unused: 验证失败/超时
    Unused --> Revoked: 管理员作废
    Unused --> Expired: 到期
    Locked --> Unused: 锁定超时(5分钟)
```

### Prisma Schema

```prisma
// schema.prisma

model CardKey {
  id           String    @id @default(cuid())
  code         String    @unique
  status       CardStatus @default(UNUSED)
  batchNo      String?
  note         String?
  createdAt    DateTime  @default(now())
  expiresAt    DateTime?
  consumedAt   DateTime?
  consumedBy   String?
  lockedAt     DateTime?
  lockJobId    String?
  
  verificationJobs VerificationJob[]
}

model VerificationJob {
  id              String    @id @default(cuid())
  sheeridUrl      String
  verificationId  String?   // 索引字段，用于去重查询
  cardKeyCode     String
  status          JobStatus @default(QUEUED)
  resultMessage   String?
  resultUrl       String?   // 成功后的目标 URL
  errorCode       String?
  upstreamReqId   String?
  startedAt       DateTime?
  finishedAt      DateTime?
  durationMs      Int?
  createdAt       DateTime  @default(now())
  
  cardKey         CardKey   @relation(fields: [cardKeyCode], references: [code])
  
  @@index([verificationId]) // 快速查询已处理的 ID
}

model DailyStats {
  id           String   @id @default(cuid())
  date         String   @unique // YYYY-MM-DD
  successCount Int      @default(0)
  failCount    Int      @default(0)
  totalCount   Int      @default(0)
}

enum CardStatus {
  UNUSED
  LOCKED
  CONSUMED
  REVOKED
  EXPIRED
}

enum JobStatus {
  QUEUED
  PROCESSING
  PENDING
  SUCCESS
  FAIL
  ERROR
  TIMEOUT
}
```

---

## Proposed Changes

### Phase 0: 项目初始化

#### [NEW] [package.json](file:///d:/code/pycode/sheerid_gemini/package.json)
Next.js 项目配置，包含依赖：
- `next`, `react`, `react-dom`
- `prisma`, `@prisma/client`
- `nanoid` (生成卡密)
- `swr` (数据获取)

#### [NEW] [prisma/schema.prisma](file:///d:/code/pycode/sheerid_gemini/prisma/schema.prisma)
数据库模型定义（CardKey, VerificationJob, DailyStats）

---

### Phase 1: 后端核心模块

#### [NEW] [src/lib/db.ts](file:///d:/code/pycode/sheerid_gemini/src/lib/db.ts)
Prisma 客户端单例

#### [NEW] [src/lib/upstream.ts](file:///d:/code/pycode/sheerid_gemini/src/lib/upstream.ts)
neigui.1key.me API 封装：
- `getCsrfToken()` - 获取 CSRF Token
- `submitBatchVerification(ids, cdk)` - 提交批量验证
- `checkPendingStatus(checkToken)` - 查询 pending 状态
- `parseSSEStream(stream)` - 解析 SSE 响应
- **SSE 事件类型处理**：`processing` → `pending` → `result`
- **超时设置**：60 秒总超时（因审核可能需要 30+ 秒）
- **SSE 容错与兜底**：断线/重复事件需幂等处理；若已获取 checkToken，则回落到 `/api/check-status` 轮询直至终态或超时

#### [NEW] [src/lib/cardkey.ts](file:///d:/code/pycode/sheerid_gemini/src/lib/cardkey.ts)
卡密业务逻辑：
- `generateKeys(count, options)` - 批量生成卡密
- `lockKey(code, jobId)` - 锁定卡密（带超时）
- `consumeKey(code)` - 消耗卡密
- `unlockKey(code)` - 释放卡密（失败回滚）
- `revokeKey(code)` - 作废卡密

> [!IMPORTANT]
> **卡密消耗时机**：仅在收到 `success` 事件后才消耗卡密，`fail`/`error`/`timeout` 时自动回滚到 UNUSED 状态。

#### [NEW] [src/lib/verification.ts](file:///d:/code/pycode/sheerid_gemini/src/lib/verification.ts)
验证任务逻辑：
- `createVerificationJob(sheeridUrl, cardKeyCode)` - 创建任务
- `processVerification(jobId)` - 执行验证流程
- `handleVerificationResult(jobId, result)` - 处理结果
- **Pending 状态处理**：实现轮询机制，每 3 秒检查一次直到最终结果
- **超时处理**：60 秒无结果则标记为 TIMEOUT 并回滚卡密
- **并发与幂等**：同一 verificationId 只允许一个活跃任务；卡密锁与任务创建保持原子一致

---

### 后端 API 路由

#### [NEW] [src/app/api/verify/route.ts](file:///d:/code/pycode/sheerid_gemini/src/app/api/verify/route.ts)
用户验证接口（SSE 响应）：
```typescript
POST /api/verify
Body: { links: string[], cardKeys: string[] }
Response: text/event-stream
```

#### [NEW] [src/app/api/stats/route.ts](file:///d:/code/pycode/sheerid_gemini/src/app/api/stats/route.ts)
统计接口：
```typescript
GET /api/stats
Response: { todaySuccess: number, ... }
```

#### [NEW] [src/app/api/query/route.ts](file:///d:/code/pycode/sheerid_gemini/src/app/api/query/route.ts)
历史查询接口（用户用卡密查询验证状态）：
```typescript
POST /api/query
Body: { cardKey: string } | { verificationId: string }
Response: {
  found: boolean,
  status?: 'SUCCESS' | 'FAIL' | 'PENDING',
  resultUrl?: string,
  verifiedAt?: string,
  cardKeyCode?: string
}
```
> [!NOTE]
> 此接口用于本地去重检查和历史查询，不消耗 CDK 配额。

#### [NEW] [src/app/api/admin/keys/route.ts](file:///d:/code/pycode/sheerid_gemini/src/app/api/admin/keys/route.ts)
卡密管理 CRUD：
```typescript
GET    /api/admin/keys?status=...&page=...
POST   /api/admin/keys { count, expiresAt, note }
DELETE /api/admin/keys/:code
PATCH  /api/admin/keys/:code { action: 'revoke' }
```

---

### Phase 2: 用户前端

#### [NEW] [src/app/page.tsx](file:///d:/code/pycode/sheerid_gemini/src/app/page.tsx)
主页面 - 验证入口

#### [NEW] [src/app/globals.css](file:///d:/code/pycode/sheerid_gemini/src/app/globals.css)
全局样式 - 现代暗色主题

#### [NEW] [src/components/VerificationForm.tsx](file:///d:/code/pycode/sheerid_gemini/src/components/VerificationForm.tsx)
验证表单组件：
- 单条/批量模式切换
- SheerID 链接输入（支持 URL 或纯 ID）
- 卡密输入
- 数量匹配校验
- **前端即时验证** - 粘贴时立即校验 verificationId 格式：
  - 长度必须为 24 位
  - 仅支持十六进制字符
  - 前缀必须为 `69` 或 `6a`
  - 校验失败时显示即时反馈，阻止无效请求发送到后端

#### [NEW] [src/lib/validation.ts](file:///d:/code/pycode/sheerid_gemini/src/lib/validation.ts)
verificationId 校验逻辑：
```typescript
const VALID_ID_REGEX = /^(69|6a)[a-fA-F0-9]{22}$/i;

export function validateVerificationId(id: string): string | null {
  if (!id || id.length !== 24) return "长度必须为24位";
  if (!/^[a-fA-F0-9]+$/.test(id)) return "必须是十六进制字符";
  if (!/^(69|6a)/i.test(id)) return "前缀不合法（仅支持69或6a开头）";
  return null; // 验证通过
}

export function extractVerificationId(input: string): string | null {
  // 从 URL 中提取 verificationId 参数
  const urlMatch = input.match(/verificationId=([a-fA-F0-9]+)/);
  if (urlMatch) return urlMatch[1];
  // 从路径中提取 24+ 位 hex
  const pathMatch = input.match(/\/([a-fA-F0-9]{24,})/);
  if (pathMatch) return pathMatch[1];
  // 纯 ID
  if (/^[a-fA-F0-9]{24,}$/.test(input)) return input;
  return null;
}
```

#### [NEW] [src/components/VerificationProgress.tsx](file:///d:/code/pycode/sheerid_gemini/src/components/VerificationProgress.tsx)
进度展示组件：
- 实时显示每条验证状态
- 成功/失败动画
- 卡密消耗状态

#### [NEW] [src/components/StatsWidget.tsx](file:///d:/code/pycode/sheerid_gemini/src/components/StatsWidget.tsx)
今日统计小组件

#### [NEW] [src/components/HelpModal.tsx](file:///d:/code/pycode/sheerid_gemini/src/components/HelpModal.tsx)
帮助弹窗 - 操作指引，包含：
- **关键提示**：右键复制链接，不要点击进入后再复制
- 常见错误说明及解决方案
- SheerID 链接格式示例
- 卡密使用规则说明

---

### Phase 3: 管理员模块

#### [NEW] [src/app/admin/page.tsx](file:///d:/code/pycode/sheerid_gemini/src/app/admin/page.tsx)
管理员登录页

#### [NEW] [src/app/admin/dashboard/page.tsx](file:///d:/code/pycode/sheerid_gemini/src/app/admin/dashboard/page.tsx)
管理员仪表盘 - 卡密管理

#### [NEW] [src/components/admin/KeyGenerator.tsx](file:///d:/code/pycode/sheerid_gemini/src/components/admin/KeyGenerator.tsx)
卡密生成器

#### [NEW] [src/components/admin/KeyTable.tsx](file:///d:/code/pycode/sheerid_gemini/src/components/admin/KeyTable.tsx)
卡密列表表格（支持筛选、分页、实时刷新）

#### [NEW] [src/components/admin/KeyExport.tsx](file:///d:/code/pycode/sheerid_gemini/src/components/admin/KeyExport.tsx)
卡密导出功能

**安全增强**：
- 登录接口速率限制（防爆破）
- 会话过期策略（短期 token/cookie）
- 管理员操作审计日志（生成/作废/导出）

---

## Verification Plan

### 自动化测试

1. **单元测试 - 卡密状态机**
```bash
npm run test -- src/lib/__tests__/cardkey.test.ts
```
测试覆盖：
- 生成卡密格式正确
- 锁定/解锁逻辑
- 消耗后不可重复使用
- 过期检测

2. **集成测试 - API 路由**
```bash
npm run test -- src/app/api/__tests__/
```
测试覆盖：
- 验证接口参数校验
- 卡密 CRUD 操作

### 浏览器测试

3. **用户验证流程**
- 打开 http://localhost:3000
- 输入测试用 SheerID 链接（可模拟或使用真实链接）
- 输入测试卡密
- 验证结果正确显示
- 成功时卡密状态变为 CONSUMED
- 失败时卡密状态保持 UNUSED

4. **管理员功能**
- 打开 http://localhost:3000/admin
- 登录管理员账号
- 生成 10 个卡密
- 搜索、筛选卡密
- 作废一个卡密
- 导出 CSV

### 手动验证

5. **真实 API 对接测试**

> [!CAUTION]
> 此测试将消耗您的 CDK 配额，请谨慎使用！

步骤：
1. 获取一个真实的 SheerID 验证链接
2. 在系统中生成一个测试卡密
3. 使用该卡密和链接发起验证
4. 观察上游 API 返回的 SSE 事件
5. 确认验证结果正确处理（成功消耗卡密/失败回滚）

---

## 项目目录结构

```
sheerid_gemini/
├── prisma/
│   └── schema.prisma
├── src/
│   ├── app/
│   │   ├── api/
│   │   │   ├── verify/route.ts
│   │   │   ├── query/route.ts      # 历史查询接口
│   │   │   ├── stats/route.ts
│   │   │   └── admin/keys/route.ts
│   │   ├── admin/
│   │   │   ├── page.tsx
│   │   │   └── dashboard/page.tsx
│   │   ├── globals.css
│   │   ├── layout.tsx
│   │   └── page.tsx
│   ├── components/
│   │   ├── admin/
│   │   │   ├── KeyGenerator.tsx
│   │   │   ├── KeyTable.tsx
│   │   │   └── KeyExport.tsx
│   │   ├── VerificationForm.tsx
│   │   ├── VerificationProgress.tsx
│   │   ├── StatsWidget.tsx
│   │   └── HelpModal.tsx
│   └── lib/
│       ├── db.ts
│       ├── upstream.ts
│       ├── cardkey.ts
│       ├── verification.ts
│       └── validation.ts           # verificationId 校验
├── package.json
└── README.md
```

---

## 配置项

环境变量 (`.env`)：
```env
# 数据库
DATABASE_URL="file:./dev.db"

# neigui.1key.me API CDK
UPSTREAM_CDK="your_cdk_here"

# 管理员密码
ADMIN_PASSWORD="your_secure_password"

# 时区
TZ="Asia/Shanghai"
```

> [!NOTE]
> 请勿提交 `.env`/`.env.local` 到仓库，真实 CDK 仅通过环境变量注入。

---

## Phase 5: VPS 部署

### 部署目标

| 项目 | 配置 |
|------|------|
| 域名 | `91gemini.indevs.in` |
| VPS IP | `216.36.104.21` |
| 代理 | Cloudflare (橙色云朵) |
| SSL | Cloudflare 提供 (Full 模式) |

### 部署架构

```mermaid
flowchart LR
    U[用户] --> CF[Cloudflare CDN]
    CF -->|HTTPS| NG[Nginx :443]
    NG -->|HTTP| APP[Next.js :3000]
    APP --> DB[(SQLite)]
    APP --> UP[neigui.1key.me]
```

### 方案 A: Docker 部署（推荐）

#### [NEW] [Dockerfile](file:///d:/code/pycode/sheerid_gemini/Dockerfile)
```dockerfile
FROM node:20-alpine AS builder
WORKDIR /app
COPY package*.json ./
RUN npm ci
COPY . .
RUN npx prisma generate
RUN npm run build

FROM node:20-alpine AS runner
WORKDIR /app
COPY --from=builder /app/.next/standalone ./
COPY --from=builder /app/.next/static ./.next/static
COPY --from=builder /app/prisma ./prisma
EXPOSE 3000
CMD ["node", "server.js"]
```

#### [NEW] [docker-compose.yml](file:///d:/code/pycode/sheerid_gemini/docker-compose.yml)
```yaml
version: '3.8'
services:
  app:
    build: .
    ports:
      - "3000:3000"
    environment:
      - DATABASE_URL=file:./data/prod.db
      - UPSTREAM_CDK=${UPSTREAM_CDK}
      - ADMIN_PASSWORD=${ADMIN_PASSWORD}
    volumes:
      - ./data:/app/data
    restart: unless-stopped
```

### 方案 B: PM2 部署

#### [NEW] [ecosystem.config.js](file:///d:/code/pycode/sheerid_gemini/ecosystem.config.js)
```javascript
module.exports = {
  apps: [{
    name: 'sheerid-gemini',
    script: 'node_modules/.bin/next',
    args: 'start',
    cwd: '/var/www/sheerid_gemini',
    env: {
      NODE_ENV: 'production',
      PORT: 3000
    }
  }]
};
```

### Nginx 配置

#### [NEW] [nginx/sheerid.conf](file:///d:/code/pycode/sheerid_gemini/nginx/sheerid.conf)
```nginx
server {
    listen 80;
    listen 443 ssl http2;
    server_name 91gemini.indevs.in;

    # Cloudflare Origin Certificate (可选，Full Strict 模式需要)
    ssl_certificate /etc/nginx/ssl/cloudflare-origin.pem;
    ssl_certificate_key /etc/nginx/ssl/cloudflare-origin.key;

    location / {
        proxy_pass http://127.0.0.1:3000;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_cache_bypass $http_upgrade;
        
        # SSE 支持
        proxy_buffering off;
        proxy_read_timeout 86400;
    }
}
```

### Cloudflare 配置

| 设置 | 值 | 说明 |
|------|-----|------|
| SSL/TLS 模式 | **Full** | Cloudflare → 服务器加密（可用自签名证书） |
| Always Use HTTPS | 开启 | HTTP 自动跳转 HTTPS |
| Minimum TLS | 1.2 | 安全最低版本 |
| Caching | 标准 | 静态资源缓存 |

> [!TIP]
> 使用 Cloudflare 的 **Origin Certificate** 可以在 Full (Strict) 模式下工作，有效期可达 15 年。

### 部署步骤

1. **本地构建**
```bash
npm run build
```

2. **上传到 VPS**
```bash
rsync -avz --exclude node_modules --exclude .git ./ root@216.36.104.21:/var/www/sheerid_gemini/
```

3. **VPS 上执行**
```bash
cd /var/www/sheerid_gemini
npm ci --production
npx prisma migrate deploy
pm2 start ecosystem.config.js
# 或使用 Docker
docker-compose up -d
```

4. **配置 Nginx**
```bash
sudo cp nginx/sheerid.conf /etc/nginx/sites-available/
sudo ln -s /etc/nginx/sites-available/sheerid.conf /etc/nginx/sites-enabled/
sudo nginx -t && sudo systemctl reload nginx
```

---

## 里程碑时间线

| 阶段 | 预计工作量 | 核心产出 |
|------|-----------|---------|
| Phase 0 | 10 分钟 | 项目初始化、数据库 |
| Phase 1 | 40 分钟 | 后端 API、上游对接 |
| Phase 2 | 30 分钟 | 用户界面 |
| Phase 3 | 30 分钟 | 管理员界面 |
| Phase 4 | 20 分钟 | 测试、优化 |
| Phase 5 | 20 分钟 | VPS 部署、Nginx、Cloudflare |

**总计：约 2.5-3 小时**

---

## 开发者须知

> [!NOTE]
> 你的 API CDK 请通过环境变量 `UPSTREAM_CDK` 配置
> 使用 CDK 时最多可同时验证 5 个 SheerID 链接。

> [!TIP]
> 建议先用小批量测试 API 对接，确认逻辑正确后再开放批量功能。

---

## 录屏演示

以下是 API 文档站点的探索过程：

![API Documentation Exploration](file:///C:/Users/WuWenbin/.gemini/antigravity/brain/c026cb27-90dd-4bd0-87bc-db8732cf54f2/api_documentation_exploration_1770009524745.webp)
